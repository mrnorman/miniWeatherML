#!/bin/bash

source $MODULESHOME/init/bash
module purge
module load DefApps gcc/9.3.0 cuda/11.4.0 cmake hdf5 curl sz zlib netcdf-c parallel-netcdf open-ce/1.2.0-py37-0
# module load DefApps open-ce/1.1.3-py36-0 gcc/9.3.0 cuda/11.4.0 cmake hdf5 curl sz zlib netcdf-c parallel-netcdf
# module load DefApps gcc/7.5.0 spectrum-mpi/10.4.0.3-20210112 netcdf-c cmake parallel-netcdf open-ce/1.1.3-py36-0 hdf5

export CC=mpicc
export FC=mpif90
export CXX=mpic++

export YAKL_ARCH=CUDA

export YAKL_CUDA_FLAGS="-DHAVE_MPI -O3 -arch sm_70 --use_fast_math -DYAKL_PROFILE -I${OLCF_NETCDF_C_ROOT}/include -I${OLCF_PARALLEL_NETCDF_ROOT}/include -I/ccs/home/imn/yaml/include -ccbin mpic++"
export YAKL_F90_FLAGS="-O2 -ffree-line-length-none"
export YAKL_C_FLAGS="-O3"
export NCFLAGS="`${OLCF_NETCDF_C_ROOT}/bin/nc-config --libs` -L/ccs/home/imn/yaml/lib64 -lyaml-cpp -L${OLCF_PARALLEL_NETCDF_ROOT}/lib -lpnetcdf"

export TORCHDIR="/sw/summit/open-ce/anaconda-base/envs/open-ce-1.2.0-py37-0/lib/python3.7/site-packages"
export TORCH_CMAKE=${TORCHDIR}/torch

unset CXXFLAGS
unset FFLAGS
unset F77FLAGS
unset F90FLAGS
